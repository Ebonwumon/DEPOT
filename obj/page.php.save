<?php
require_once('obj/db.php');
session_start();
class Page {
	public $date;
	public $html;
	protected $db;

	public function __construct() {
		$this->db = new DB("test","green","test","localhost");
		$this->date = date("d-m-Y H:i:s");
	}

	public function __toString() {
		return (string)$this->html;	
	}

	function permissions($reqd) {
		switch ($reqd) {
			case 'loggedIn': 
				if (isset($_SESSION['username'])) return true;
				else $this->redirect("login")
		}
	}

	function redirect($dest) {
		
		switch ($dest) {
			case 'login': header("Refresh: 3, url=?page=login");
		}
	}

	function blog() {
		$this->html = "<script src='http://feeds.feedburner.com/DepotWarehouseBlag?format=sigpro' type='text/javascript' ></script>";
	}

	function forum() {
		require_once('obj/ForumList.php');
		$forumList = new ForumList();
		$this->html .= $forumList->showForums();
	}

	function viewForum($fid) { //TODO get rid of magic numbers
		require_once('obj/Forum.php');
		$forumObj = new Forum($fid, array('pageNum' => 0, 'pageLimit' => 35));
		$this->html .= $forumObj->displayTopics();
		$this->html .= $forumObj->displayNewPostButton();